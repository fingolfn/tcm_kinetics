####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##     ########    ##     #######                    ##   ##           ########                                                            
##     ##          ##    ##                          ##   ##                 ##                                   
##     ##          ##   ##                      #################            ##                                       
##     ########    ##   ##   ####                    ##   ##           ########                                              
##     ##          ##   ##      ##              #################            ##                                              
##     ##          ##    ##     ##                  ##   ##                  ##                                      
##     ##          ##     #######                   ##   ##           ########                                                     
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################


##########################################
#Figure 3B High Affinity Heparin:
##########################################

heparin_high<-read.csv("expr_data/3B-Heparin-hi.csv",as.is=T,header=T)


plot(heparin_high[,3],heparin_high[,4],
     log="x",pch=16,ylim=c(0,0.8),
     xlab="High Affinity Heparin (nM)",ylab="kobs s^-1")


##########################################
#Figure 3C Low Affinity Heparin:
##########################################

heparin_low<-read.csv("expr_data/3C-Heparin-lo.csv",as.is=T,header=T)


plot(heparin_low[,3],heparin_low[,4],
     log="x",pch=16,ylim=c(0,0.02),
     xlab="Low Affinity Heparin (uM)",ylab="kobs s^-1")

arrows(heparin_low[,3], heparin_low[,4]-heparin_low[,5], 
       heparin_low[,3], heparin_low[,4]+heparin_low[,5], length=0.05, angle=90, code=3)



####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##     ########    ##     #######                    ##   ##           ########                                                            
##     ##          ##    ##                          ##   ##                 ##                                   
##     ##          ##   ##                      #################            ##                                       
##     ########    ##   ##   ####                    ##   ##           ########                                              
##     ##          ##   ##      ##              #################            ##                                              
##     ##          ##    ##     ##                  ##   ##                  ##                                      
##     ##          ##     #######                   ##   ##           ########                                                     
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##     ########      ########       #######    ############      ##           #########        #######                        
##     ##     ##     ##     ##     ##     ##        ##          ####         ##               ##             
##     ##     ##     ##    ##      ##     ##        ##         ##  ##       ##                ##              
##     ########      #######       ##     ##        ##        ##    ##      ##                 #######              
##     ##            ##    ##      ##     ##        ##       ##########     ##                       ##         
##     ##            ##     ##     ##     ##        ##      ##        ##     ##                      ##          
##     ##            ##      ##     #######         ##     ##          ##     #########        #######                        
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################  
##   ##     ##   ##   ###     ##   ########  ##########  ##     #######   #######                                                                                                      
##   ##    ##    ##   ####    ##   ##            ##      ##    ##        ##                                                                                  
##   ##   ##     ##   ## ##   ##   ##            ##      ##   ##         ##                                                                                     
##   ######      ##   ##  ##  ##   #######       ##      ##   ##          ######                                                                                           
##   ##   ##     ##   ##   ## ##   ##            ##      ##   ##               ##                                                                               
##   ##    ##    ##   ##    ####   ##            ##      ##    ##              ##                                                                                
##   ##     ##   ##   ##     ###   #######       ##      ##     ######    ######                                                                                            
####################################################################################################################################################################################################################################################################
#################################################################################################################################################################################################################################################################### 



########################################################################################################################################################################
#Figure 3E:  protac binding affinity distributions
########################################################################################################################################################################
protac_db<-read.csv("databases/protac.csv",as.is=T,header=1)


hist(log10(as.numeric(protac_db$Kd..nM..Protac.to.Target.)),breaks=20,col=rgb(0,0,0,0.3),xlim=c(-0.3,4.3),ylim=c(0,20),
     xlab="Kd (nM)",border=rgb(0,0,0,0.3))


hist(log10(as.numeric(protac_db$Kd..nM..Protac.to.E3.)),breaks=20,col=rgb(1,0,0,0.5),add=T,border=rgb(1,0,0,0.5))

legend("topright",legend=c("Target Kd","E3 Kd"),fill=c(rgb(0,0,0,0.3),rgb(1,0,0,0.5)),text.col=c("grey","darkred"))



########################################################################################################################################################################
#Figure 3F:  protac-mediated degredation time-courses
########################################################################################################################################################################


##########################
#Androgen Receptor Degredation
##########################
ar_degretation<-read.csv("expr_data/3F-AR.csv",as.is=T,header=T)


plot(ar_degretation[,1],ar_degretation[,2],
     pch=16,ylim=c(0,110),
     xlab="Time (minutes)",ylab="Androgen Receptor %")
arrows(ar_degretation[,1], ar_degretation[,2]-ar_degretation[,3], 
       ar_degretation[,1], ar_degretation[,2]+ar_degretation[,3], length=0.05, angle=90, code=3)

points(ar_degretation[,1],ar_degretation[,4],
       pch=16,ylim=c(0,110),
       xlab="Time (minutes)",ylab="Androgen Receptor %")
arrows(ar_degretation[,1], ar_degretation[,4]-ar_degretation[,5], 
       ar_degretation[,1], ar_degretation[,4]+ar_degretation[,5], length=0.05, angle=90, code=3)




##########################
#AURKA Degredation
##########################
aurka_degretation<-read.csv("expr_data/3F-aurka-dgrd.csv",as.is=T,header=T)


#1uM
plot(aurka_degretation[,1],aurka_degretation[,2],
     pch=16,ylim=c(0,120),
     xlab="Time (minutes)",ylab="% AURKA-Venus Remaining")
arrows(aurka_degretation[,1], aurka_degretation[,2]-aurka_degretation[,3], 
       aurka_degretation[,1], aurka_degretation[,2]+aurka_degretation[,3], length=0.05, angle=90, code=3)

#100nM
points(aurka_degretation[,1],aurka_degretation[,5],pch=16)
arrows(aurka_degretation[,1], aurka_degretation[,5]-aurka_degretation[,6], 
       aurka_degretation[,1], aurka_degretation[,5]+aurka_degretation[,6], length=0.05, angle=90, code=3)


#10nM
points(aurka_degretation[,1],aurka_degretation[,8],pch=16)
arrows(aurka_degretation[,1], aurka_degretation[,8]-aurka_degretation[,9], 
       aurka_degretation[,1], aurka_degretation[,8]+aurka_degretation[,9], length=0.05, angle=90, code=3)








####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##     ########    ##     #######                    ##   ##         ##     ##                                                          
##     ##          ##    ##                          ##   ##         ##     ##                                      
##     ##          ##   ##                      #################    ##     ##                                         
##     ########    ##   ##   ####                    ##   ##         ###########                                                 
##     ##          ##   ##      ##              #################           ##                                               
##     ##          ##    ##     ##                  ##   ##                 ##                                     
##     ##          ##     #######                   ##   ##                 ##                                             
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################







########################################################################################################################################################################
#Figure 4B:  expression dependance of ADCC
########################################################################################################################################################################

adcc_expression<-read.csv("expr_data/4B-expression.csv",as.is=T,header=T)


plot(adcc_expression[,2],adcc_expression[,3],
     pch=16,log="x",xlim=c(1,100000000),
     xlab="Receptor Expression",ylab="Cytotoxicity (%)")


########################################################################################################################################################################
#Figure 4E:  Time-dependance of ADCC
########################################################################################################################################################################

adcc_timecourse<-read.csv("expr_data/4D-time.csv",as.is=T,header=T)




plot(adcc_timecourse[,1],adcc_timecourse[,8],
     pch=16,ylim=c(0,50),
     xlab="Time (hours)",ylab="Cr Release (%)")
arrows(adcc_timecourse[,1], adcc_timecourse[,8]-adcc_timecourse[,9], 
       adcc_timecourse[,1], adcc_timecourse[,8]+adcc_timecourse[,9], length=0.05, angle=90, code=3)



points(adcc_timecourse[,1],adcc_timecourse[,6],
       pch=16,ylim=c(0,50),
       xlab="Time (hours)",ylab="Cr Release (%)")
arrows(adcc_timecourse[,1], adcc_timecourse[,6]-adcc_timecourse[,7], 
       adcc_timecourse[,1], adcc_timecourse[,6]+adcc_timecourse[,7], length=0.05, angle=90, code=3)



points(adcc_timecourse[,1],adcc_timecourse[,4],
       pch=16,ylim=c(0,50),
       xlab="Time (hours)",ylab="Cr Release (%)")
arrows(adcc_timecourse[,1], adcc_timecourse[,4]-adcc_timecourse[,5], 
       adcc_timecourse[,1], adcc_timecourse[,4]+adcc_timecourse[,5], length=0.05, angle=90, code=3)

points(adcc_timecourse[,1],adcc_timecourse[,2],
       pch=16,ylim=c(0,50),
       xlab="Time (hours)",ylab="Cr Release (%)")
arrows(adcc_timecourse[,1], adcc_timecourse[,2]-adcc_timecourse[,3], 
       adcc_timecourse[,1], adcc_timecourse[,2]+adcc_timecourse[,3], length=0.05, angle=90, code=3)




########################################################################################################################################################################
#Figure 4F:  Dose-Dependance of ADCC
########################################################################################################################################################################

adcc_doseresponse<-read.csv("expr_data/4E-dose.csv",as.is=T,header=T)




plot(adcc_doseresponse[,1],adcc_doseresponse[,2],
     pch=16,ylim=c(0,40),
     xlab="Concentration (log10(ug/mL))",ylab="Lysis (%)")


points(adcc_doseresponse[,1],adcc_doseresponse[,3],
       pch=16,ylim=c(0,50),
       xlab="Concentration (log10(ug/mL))",ylab="Lysis (%)")

points(adcc_doseresponse[,1],adcc_doseresponse[,4],
       pch=16,ylim=c(0,50),
       xlab="Concentration (log10(ug/mL))",ylab="Lysis (%)")





####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##     ########    ##     #######                    ##   ##           ########      ########                                                         
##     ##          ##    ##                          ##   ##          ##                   ##                
##     ##          ##   ##                      #################     ##                  ##                    
##     ########    ##   ##   ####                    ##   ##           ########          ##                               
##     ##          ##   ##      ##              #################             ##        ##                   
##     ##          ##    ##     ##                  ##   ##                   ##       ##              
##     ##          ##     #######                   ##   ##            ########       ##                              
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##     ###     ##    #######    ########    ###      ###         ##        ##                                                                           
##     ####    ##   ##     ##   ##     ##   ####    ####        ####       ##                                                               
##     ## ##   ##   ##     ##   ##     ##   ## ##  ## ##       ##  ##      ##                                                        
##     ##  ##  ##   ##     ##   ########    ##  ####  ##      ##    ##     ##                                                                                         
##     ##   ## ##   ##     ##   ##    ##    ##   ##   ##     ##########    ##                                                        
##     ##    ####   ##     ##   ##     ##   ##        ##    ##        ##   ##                                              
##     ##     ###    #######    ##      ##  ##        ##   ##          ##  #########                                              
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################
##    ########     ##     #######    ##########   #######      ##    #######    ##    ##   ##########   ##   ######    ###     ##                                                                           
##    ##     ##    ##    ##              ##       ##    ##     ##    ##    ##   ##    ##       ##       ##  ##    ##   ####    ##                                   
##    ##      ##   ##    ##              ##       ##    ##     ##    ##    ##   ##    ##       ##       ##  ##    ##   ## ##   ##                                                                                                                            
##    ##      ##   ##     #######        ##       #######      ##    #######    ##    ##       ##       ##  ##    ##   ##  ##  ##                                                                                           
##    ##      ##   ##           ##       ##       ##   ##      ##    ##    ##   ##    ##       ##       ##  ##    ##   ##   ## ##                                                                                                                
##    ##     ##    ##           ##       ##       ##    ##     ##    ##    ##   ##    ##       ##       ##  ##    ##   ##    ####                                                         
##    ########     ##     #######        ##       ##     ##    ##    #######     ######        ##       ##   ######    ##     ###                                                                                                                                     
####################################################################################################################################################################################################################################################################
####################################################################################################################################################################################################################################################################


load("databases/ChEMBL_Kds_simple.RData") #SOURCE:  
load("databases/milo_kcat_db.RData") #SOURCE
load("databases/proteomics_abs.RData") #SOURCE:

##########################################################################################
#ChEMBL:  Kd
##########################################################################################
ChEMBL_kds<-as.numeric(ChEMBL_Kis_simple$Ki..nM.)

hist(log10(ChEMBL_kds),breaks=100,border="grey",col="grey",freq=F,xlim=c(-1.5,6))
lines(density(log10(ChEMBL_kds),adjust=2),col="black",lwd=1,lty=1)


##########################################################################################
#MILO:  kcats
##########################################################################################
tmp_kcat<-log10(milo_kcat_db$kcat..1.sec.)
tmp_kcat_na<-tmp_kcat[-is.na(tmp_kcat)]

hist(tmp_kcat_na,breaks=50,border="grey",col="grey",freq=F,xlim=c(-2,4))
lines(density(na.omit(tmp_kcat_na),adjust=2),col="black",lwd=1,lty=1)



##########################################################################################
#PROTEOMICS:  protein expression 
##########################################################################################
hist(log10(proteomics_abs$Protein.copy.number.average..molecules.cell./3000),breaks=50,border="grey",col="grey",freq=F,xlim=c(-1.5,6))
lines(density(log10(proteomics_abs$Protein.copy.number.average..molecules.cell./3000),adjust=2),col="black",lwd=1,lty=1)

##########################################################################################
#PROTEOMICS:  protein half-life
##########################################################################################

hist(log10(proteomics_abs$Protein.half.life.experiment..h.),breaks=100,border="grey",col="grey",freq=F,xlim=c(0.5,2.5))
lines(density(log10(proteomics_abs$Protein.half.life.experiment..h.),adjust=2),col="black",lwd=1,lty=1)

















